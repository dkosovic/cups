From 23be2dad137fb924f78eba6294eb5c8c208d5fa0 Mon Sep 17 00:00:00 2001
From: Zdenek Dohnal <zdohnal@redhat.com>
Date: Fri, 24 Mar 2023 09:37:25 +0100
Subject: [PATCH] configure: Raise FORTIFY_SOURCE level to 3

GCC supports level 3 for some time, try using it.
---
 config-scripts/cups-compiler.m4 | 4 ++--
 configure                       | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/config-scripts/cups-compiler.m4 b/config-scripts/cups-compiler.m4
index 266d909ed..25e7f7aa5 100644
--- a/config-scripts/cups-compiler.m4
+++ b/config-scripts/cups-compiler.m4
@@ -108,8 +108,8 @@ AS_IF([test -n "$GCC"], [
     ], [
 	# Otherwise use the Fortify enhancements to catch any unbounded
 	# string operations...
-	CFLAGS="$CFLAGS -D_FORTIFY_SOURCE=2"
-	CXXFLAGS="$CXXFLAGS -D_FORTIFY_SOURCE=2"
+	CFLAGS="$CFLAGS -D_FORTIFY_SOURCE=3"
+	CXXFLAGS="$CXXFLAGS -D_FORTIFY_SOURCE=3"
     ])
 
     # Default optimization options...
diff --git a/configure b/configure
index 40d9e7a71..d50ee6a7d 100755
--- a/configure
+++ b/configure
@@ -8102,8 +8102,8 @@ else $as_nop
 
 	# Otherwise use the Fortify enhancements to catch any unbounded
 	# string operations...
-	CFLAGS="$CFLAGS -D_FORTIFY_SOURCE=2"
-	CXXFLAGS="$CXXFLAGS -D_FORTIFY_SOURCE=2"
+	CFLAGS="$CFLAGS -D_FORTIFY_SOURCE=3"
+	CXXFLAGS="$CXXFLAGS -D_FORTIFY_SOURCE=3"
 
 fi
 
-- 
2.40.0

